FROM nvidia/cuda:11.3.1-cudnn8-devel-ubuntu18.04

# Python 3.6とpipのインストール
RUN apt-get update && \
    apt-get install -y --no-install-recommends \
        python3.6 \
        python3.6-dev \
        python3-pip && \
    rm -rf /var/lib/apt/lists/*

# pythonとpipコマンドをpython3.6とpip3にリンク
RUN ln -s /usr/bin/python3.6 /usr/bin/python && \
    ln -s /usr/bin/pip3 /usr/bin/pip

# pipのアップグレード
RUN pip install --upgrade pip

# PyTorchのインストール（CUDA 11.3対応）
RUN pip install torch==1.10.0+cu113 torchvision==0.11.1+cu113 torchaudio==0.10.0+cu113 \
    -f https://download.pytorch.org/whl/cu113/torch_stable.html